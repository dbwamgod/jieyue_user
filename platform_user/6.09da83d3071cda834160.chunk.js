webpackJsonp([6],{274:function(e,t,a){"use strict";function i(e){l||(a(414),a(416))}Object.defineProperty(t,"__esModule",{value:!0});var n=a(327),o=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);var r=a(418),d=a.n(r),l=!1,c=a(0),u=i,p=c(o.a,d.a,!1,u,"data-v-1b10d217",null);p.options.__file="src\\views\\access\\access-test.vue",t.default=p.exports},327:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(63),o=i(n),s=a(32),r=i(s),d=a(31),l=i(d),c=a(100),u=i(c),p=a(2),h=i(p);t.default={inject:["reload"],data:function(){var e=this;return{SpinType:!1,addResource:!1,searchShow:!1,flag:0,searchWord:"",real:[],modal2:!1,dataCount:0,page:{pageIndex:1,pageSize:10},historyColumns:[{title:"昵称",key:"nickname"},{title:"手机号",key:"mobile"},{title:"邮箱",key:"email"},{title:"员工编号",key:"employeeCode"},{title:"组织机构名称",key:"organizationName"},{align:"center",title:"操作",width:"300px",key:"deletetStatus",render:function(t,a){return t("div",[e.operation.edit||e.operation.edit_del||e.operation.edit_binding||e.operation.edit_del_binding?t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"2%"},on:{click:function(){e.formItem=JSON.parse((0,l.default)(e.historyData[a.index])),e.real=JSON.parse((0,l.default)(e.historyData[a.index])),e.modal2=!0,h.default.set("user_num",a.index)}}},"修改"):"",e.operation.del||e.operation.edit_del||e.operation.del_binding||e.operation.edit_del_binding?t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.$Modal.confirm({title:"删除警告",content:"<p>您确定要删除该用户吗</p>",loading:!0,onOk:function(){setTimeout(function(){e.user_Delete(e.historyData[a.index].userId,a.index)},0)}})}}},"删除"):"",e.operation.binding||e.operation.edit_binding||e.operation.del_binding||e.operation.edit_del_binding?t("Button",{props:{type:"success",size:"small"},style:{marginLeft:"2%"},on:{click:function(){e.searchWord&&e.$store.commit("bindingChange",e.searchWord),h.default.set("user_search",e.searchWord),h.default.set("user_index",e.page.pageIndex),e.$router.push({name:"bang_access",query:{data:(0,l.default)(e.historyData[a.index].userId)}})}}},"绑定角色"):""])}}],historyData:[],addUser:!1,formItem:{email:"",mobile:"",nickname:"",organizationId:""},loseList:!1,searchInfo:!1,operation:{edit:!1,del:!1,binding:!1,edit_del:!1,edit_binding:!1,del_binding:!1,edit_del_binding:!1},space:{}}},created:function(){var e=this;h.default.remove("home_index"),h.default.remove("res_index"),h.default.remove("role_index"),this.$store.commit("bindingChange"),0!==this.$store.state.app.binding.length&&(this.searchWord=this.$store.state.app.binding,this.user_List()),JSON.parse(localStorage.getItem("Jurisdiction"))?JSON.parse(localStorage.getItem("Jurisdiction")).forEach(function(t){t.child.forEach(function(t){"查询用户列表"==t.resourceName?e.searchShow=!0:"查询监听失败列表"==t.resourceName?e.loseList=!0:"新增用户"==t.resourceName?e.addUser=!0:"修改用户"==t.resourceName?(e.operation.edit=!0,e.flag=1):"删除用户"==t.resourceName?1===e.flag?(e.operation.edit_del=!0,e.flag=2):(e.del=!0,e.flag=3):"绑定角色"==t.resourceName&&(2===e.flag?e.operation.edit_del_binding=!0:0===e.flag?e.operation.binding=!0:3===e.flag?e.operation.del_binding=!0:1===e.flag&&(e.operation.edit_binding=!0))})}):(this.$Message.error("无法检测到你的权限"),this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})),h.default.get("user_index")&&(this.page.pageIndex=Number(h.default.get("user_index")),h.default.remove("user_index")),this.user_List()},methods:{searchChange:function(){this.$store.commit("bindingChange",this.searchWord),this.searchInfo=!0,this.user_List()},lost:function(){this.$router.push({name:"lost_list"})},add_access:function(){this.$router.push({name:"access_add"})},user_List:function(){var e=this;this.SpinType=!0,h.default.get("user_index")&&(this.page.pageIndex=h.default.get("user_index")),h.default.get("user_search")&&(this.$store.commit("bindingChange",h.default.get("user_search")),this.searchWord=h.default.get("user_search"),h.default.remove("user_search")),this.$axios({method:"post",url:u.default.userList(),data:{keyword:this.$store.state.app.binding||"",currentPage:this.searchInfo?1:this.page.pageIndex,pageSize:this.page.pageSize},headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){200==t.data.code?(e.SpinType=!1,t.data.data?(e.historyData=t.data.data,e.dataCount=t.data.page.totalRecords):e.searchInfo?(e.dataCount=0,e.historyData=[]):(--e.page.pageIndex,e.user_List()),e.searchInfo&&(e.page.pageIndex=1),e.searchInfo=!1):e.$Message.info(t.data.msg)})},user_Delete:function(e,t){var a=this;this.$axios({method:"post",url:u.default.userDelete(),data:{userId:e},headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){200==e.data.code?(a.historyData.length<2?a.$axios({method:"post",url:u.default.userList(),data:{keyword:a.searchWord,currentPage:1,pageSize:a.page.pageSize},headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){200==e.data.code?e.data.data?(a.historyData=e.data.data,a.dataCount=e.data.page.totalRecords):(a.dataCount=0,a.historyData=[]):a.$Message.info(e.data.msg)}):(a.$Message.info("已删除"),a.searchInfo=!0,a.user_List()),a.$Modal.remove()):(a.$Modal.remove(),a.$Message.info(e.data.msg))})},user_Update:function(){var e=this;this.$axios({method:"post",url:u.default.userUpdate(),data:{email:this.formItem.email,employeeCode:this.formItem.employeeCode,mobile:this.formItem.mobile,nickname:this.formItem.nickname,orderNo:this.formItem.orderNo,userId:this.formItem.userId},headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){200==t.data.code?e.historyData[h.default.get("user_num")].nickname=e.formItem.nickname:e.$Message.info(t.data.msg)})},changepage:function(e){this.page.pageIndex=e,this.user_List()},okone:function(){this.user_Update(),this.$Message.info("已修改")},canceloneone:function(){var e=this;this.historyData.map(function(t){t.userId===e.real.userId&&o.default.apply(Object,[{}].concat((0,r.default)(e.real)))});this.$refs.formItem.resetFields(),this.modal2=!1,this.$Message.info("已取消")},remove:function(e){this.historyData.splice(e,1)}}}},414:function(e,t,a){var i=a(415);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(9)("4756f16a",i,!1)},415:function(e,t,a){t=e.exports=a(8)(!1),t.push([e.i,"\n.paging[data-v-1b10d217] {\n    float: right;\n    margin-top: 10px;\n    margin-right: 15px;\n}\n",""])},416:function(e,t,a){var i=a(417);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(9)("31057712",i,!1)},417:function(e,t,a){t=e.exports=a(8)(!1),t.push([e.i,"\n.aa {\n}\n",""])},418:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{position:"relative",height:"100%",padding:"10px"}},[a("Row",{staticClass:"code-row-bg",staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("Col",{attrs:{span:"4"}},[a("h2",{staticStyle:{margin:"6px 0 0 20px"}},[e._v("用户管理")])]),e._v(" "),a("Col",{staticStyle:{width:"80%","text-align":"right","margin-right":"15px"}},[a("Input",{staticStyle:{width:"17%",height:"34px"},attrs:{size:"large",placeholder:"请输入搜索内容..."},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}}),e._v(" "),a("Button",{attrs:{type:"primary"},on:{click:e.searchChange}},[a("Icon",{staticStyle:{"font-size":"17px"},attrs:{type:"ios-search-strong"}})],1),e._v(" "),e.addUser?a("Button",{attrs:{type:"primary"},on:{click:e.add_access}},[e._v("新增用户")]):e._e(),e._v(" "),e.loseList?a("Button",{attrs:{type:"primary"},on:{click:e.lost}},[e._v("失败列表")]):e._e()],1)],1),e._v(" "),a("Table",{staticStyle:{margin:"5px 15px 0 15px"},attrs:{columns:e.historyColumns,data:e.historyData,loading:e.SpinType}}),e._v(" "),a("Page",{staticClass:"paging",attrs:{total:e.dataCount,"page-size":e.page.pageSize,current:e.page.pageIndex,"show-total":""},on:{"on-change":e.changepage}}),e._v(" "),a("Modal",{attrs:{title:"修改信息"},on:{"on-ok":e.okone,"on-cancel":e.canceloneone},model:{value:e.modal2,callback:function(t){e.modal2=t},expression:"modal2"}},[a("Form",{ref:"formItem",attrs:{model:e.formItem}},[a("FormItem",{attrs:{prop:"email"}},[a("p",[e._v("邮箱")]),e._v("\n                "+e._s(this.formItem.email)+"\n                ")]),e._v(" "),a("FormItem",{attrs:{prop:"mobile"}},[a("p",[e._v("手机号")]),e._v("\n                "+e._s(this.formItem.mobile)+"\n                ")]),e._v(" "),a("FormItem",{attrs:{prop:"nickname"}},[a("p",[e._v("昵称")]),e._v(" "),a("Input",{attrs:{type:"text",placeholder:"昵称"},model:{value:e.formItem.nickname,callback:function(t){e.$set(e.formItem,"nickname",t)},expression:"formItem.nickname"}})],1)],1)],1)],1)},n=[];i._withStripped=!0;var o={render:i,staticRenderFns:n};t.default=o}});