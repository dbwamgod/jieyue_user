webpackJsonp([21],{275:function(e,t,a){"use strict";function o(e){l||a(419)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(328),r=a.n(i);for(var n in i)"default"!==n&&function(e){a.d(t,e,function(){return i[e]})}(n);var s=a(421),d=a.n(s),l=!1,c=a(0),p=o,u=c(r.a,d.a,!1,p,null,null);u.options.__file="src\\views\\access\\access.vue",t.default=u.exports},328:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(31),r=o(i),n=a(100),s=o(n),d=a(2),l=o(d);t.default={inject:["reload"],name:"home",data:function(){var e=this;return{ruleInline:{roleName:[{required:!0,type:"string",pattern:/\S/,message:"请输入正确的角色名且不能包含空格",trigger:"blur"}]},SpinType:!1,real:[],modal2:!1,formItem:{description:"",orderNo:"",roleName:""},operation:{edit:!1,del:!1,binding:!1,edit_del:!1,edit_binding:!1,del_binding:!1,edit_del_binding:!1},searchInfo:!1,addResource:!1,addRole:!1,searchShow:!1,flag:0,searchWord:"",allMuch:0,page:{pageIndex:1,pageSize:10},data3:[],formRight:{description:"",orderNo:"",roleId:"",roleName:"",userId:""},columns2:[{title:"租户名称",key:"tenantName"},{title:"角色名称",key:"roleName"},{title:"描述",key:"description"},{title:"更新时间",key:"modifyTime"},{title:"操作",key:"action",width:"300px",render:function(t,a){return t("div",[e.operation.edit||e.operation.edit_del||e.operation.edit_binding||e.operation.edit_del_binding?t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"10px"},on:{click:function(){e.edit(a.index)}}},"编辑"):"",e.operation.del||e.operation.edit_del||e.operation.del_binding||e.operation.edit_del_binding?t("Button",{props:{type:"error",size:"small"},style:{color:"white",marginRight:"10px"},on:{click:function(){e.$Modal.confirm({title:"删除警告",content:"<p>您确定要删除该角色吗</p>",loading:!0,onOk:function(){setTimeout(function(){l.default.set("del",e.page.pageIndex),e.$axios({method:"post",url:s.default.role_del(),data:{roleId:e.data3[a.index].roleId,userId:l.default.get("user_userId")},headers:{Authorization:l.default.get("token"),"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){200==t.data.code?(e.data3.length<2?e.$axios({method:"post",url:s.default.role_list(),data:{keyword:e.searchWord,currentPage:e.page.pageIndex?1:--e.page.pageIndex,pageSize:e.page.pageSize},headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){200==t.data.code?(e.page.pageIndex>1&&--e.page.pageIndex,t.data.data?(e.data3=t.data.data,e.allMuch=t.data.page.totalRecords):(e.allMuch=0,e.data3=[])):(e.$Message.info(t.data.msg),e.$Modal.remove())}):(e.role_List(),e.$Message.info("已删除"),e.searchInfo=!0),e.$Modal.remove()):(e.$Modal.remove(),e.$Message.info(t.data.msg))})},0)}})}}},"删除"):"",e.operation.binding||e.operation.edit_binding||e.operation.del_binding||e.operation.edit_del_binding?t("Button",{props:{type:"success",size:"small"},style:{color:"white"},on:{click:function(){e.searchWord&&e.$store.commit("bindingChangeRes",e.searchWord),l.default.set("role_index",e.page.pageIndex),l.default.set("role_search",e.searchWord),e.$router.push({name:"access_bang",query:{id:(0,r.default)(e.data3[a.index].roleId),pageIndex:(0,r.default)(e.page.pageIndex)}})}}},"绑定资源"):""])}}],isClickSearch:!1}},created:function(){var e=this;l.default.remove("home_index"),l.default.remove("res_index"),l.default.remove("user_index"),this.$store.commit("bindingChangeRes"),0!==this.$store.state.app.binding.length&&(this.searchWord=this.$store.state.app.bindingRes),JSON.parse(localStorage.getItem("Jurisdiction"))?JSON.parse(localStorage.getItem("Jurisdiction")).forEach(function(t){t.child.forEach(function(t){"查询角色列表"==t.resourceName?e.searchShow=!0:"新增角色"==t.resourceName?e.addRole=!0:"修改角色"==t.resourceName?(e.operation.edit=!0,e.flag=1):"删除角色"==t.resourceName?1===e.flag?(e.operation.edit_del=!0,e.flag=2):(e.del=!0,e.flag=3):"绑定资源"==t.resourceName&&(2===e.flag?e.operation.edit_del_binding=!0:0===e.flag?e.operation.binding=!0:3===e.flag?e.operation.del_binding=!0:1===e.flag&&(e.operation.edit_binding=!0))})}):(this.$Message.error("无法检测到你的权限"),this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})),l.default.get("role_index")&&(this.page.pageIndex=Number(l.default.get("role_index")),l.default.remove("role_index")),this.role_List()},methods:{searchChange:function(){this.page.pageIndex=1,this.searchInfo=!0,this.$store.commit("bindingChangeRes",this.searchWord),this.isClickSearch=!0,this.role_List()},totol:function(e){this.page.pageIndex=e,0==this.searchWord.length&&(this.searchInfo=!1),this.role_List()},add:function(){this.$router.push({name:"access_adds"})},role_List:function(e){var t=this;this.searchWord.length>=1&&(this.isClickSearch=!1),l.default.get("role_search")&&(this.$store.commit("bindingChangeRes",l.default.get("role_search")),this.searchWord=l.default.get("role_search"),l.default.remove("role_search")),this.SpinType=!0,this.$axios({method:"post",url:s.default.role_list(),data:{keyword:this.$store.state.app.bindingRes||"",currentPage:this.searchInfo&&this.isClickSearch?1:this.page.pageIndex,pageSize:this.page.pageSize},headers:{"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){200==e.data.code?(t.SpinType=!1,e.data.data?(t.data3=e.data.data,t.allMuch=e.data.page.totalRecords):t.searchInfo?(t.allMuch=0,t.data3=[]):(--t.page.pageIndex,t.role_List()),t.searchInfo=!1):t.$Message.info(e.data.msg)})},sure:function(){var e=this;this.$refs.formItem.validate(function(t){t&&(e.$axios({method:"post",url:s.default.role_update(),data:{description:e.formItem.description,orderNo:e.formItem.orderNo,roleId:e.formItem.roleId,roleName:e.formItem.roleName,userId:l.default.get("user_userId")},headers:{Authorization:l.default.get("token"),"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){if(200===t.data.code){var a=e.data3[l.default.get("role_num")];new Date;a.description=e.formItem.description,a.orderNo=e.formItem.orderNo,a.roleName=e.formItem.roleName,e.role_List()}}),e.modal2=!1,e.$Message.info("已修改"))})},cancel:function(){this.$refs.formItem.resetFields(),this.modal2=!1,this.$Message.info("已取消")},edit:function(e){this.formItem=JSON.parse((0,r.default)(this.data3[e])),this.real=JSON.parse((0,r.default)(this.data3[e])),this.modal2=!0,l.default.set("role_num",e),l.default.set("role_index",this.page.pageIndex)}}}},419:function(e,t,a){var o=a(420);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a(9)("669e2daa",o,!1)},420:function(e,t,a){t=e.exports=a(8)(!1),t.push([e.i,"\n* {\n    margin: 0;\n    padding: 0;\n}\n.tissue_header h2 {\n    line-height: 50px;\n    padding-left: 5px;\n}\n\n/* 角色授权\n  */\n.role_header ul li {\n    width: 150px;\n    height: 40px;\n    line-height: 40px;\n    text-align: center;\n    border: 1px solid #e7e7ee;\n    float: left;\n}\n",""])},421:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{position:"relative",height:"100%",padding:"10px"}},[a("Row",{staticClass:"code-row-bg",staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("Col",{attrs:{span:"4"}},[a("h2",{staticStyle:{margin:"6px 0 0 20px"}},[e._v("角色管理")])]),e._v(" "),a("Col",{staticStyle:{"text-align":"right","margin-right":"15px",width:"45%"}},[a("Input",{staticStyle:{width:"35%",height:"34px"},attrs:{size:"large",placeholder:"请输入搜索内容..."},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}}),e._v(" "),a("Button",{attrs:{type:"primary"},on:{click:e.searchChange}},[a("Icon",{staticStyle:{"font-size":"17px"},attrs:{type:"ios-search-strong"}})],1),e._v(" "),e.addRole?a("Button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("新增角色")]):e._e()],1)],1),e._v(" "),a("Table",{staticStyle:{margin:"5px 15px 0 15px"},attrs:{columns:e.columns2,data:e.data3,loading:e.SpinType}}),e._v(" "),a("Page",{staticStyle:{float:"right","margin-top":"10px","margin-right":"15px"},attrs:{total:e.allMuch,"show-total":"","page-size":e.page.pageSize,current:e.page.pageIndex},on:{"on-change":e.totol}}),e._v(" "),a("Modal",{attrs:{title:"修改信息","footer-hide":!0,closable:!1,"mask-closable":!1},model:{value:e.modal2,callback:function(t){e.modal2=t},expression:"modal2"}},[a("Form",{ref:"formItem",attrs:{model:e.formItem,rules:e.ruleInline}},[a("FormItem",{attrs:{label:"描述",prop:"description"}},[a("Input",{attrs:{placeholder:"描述"},model:{value:e.formItem.description,callback:function(t){e.$set(e.formItem,"description",t)},expression:"formItem.description"}})],1),e._v(" "),a("FormItem",{attrs:{label:"排序号",prop:"orderNo"}},[a("Input",{attrs:{placeholder:"排列顺序"},model:{value:e.formItem.orderNo,callback:function(t){e.$set(e.formItem,"orderNo",t)},expression:"formItem.orderNo"}})],1),e._v(" "),a("FormItem",{attrs:{label:"角色名称",prop:"roleName"}},[a("Input",{attrs:{placeholder:"角色名称"},model:{value:e.formItem.roleName,callback:function(t){e.$set(e.formItem,"roleName",t)},expression:"formItem.roleName"}})],1)],1),e._v(" "),a("div",{staticStyle:{"margin-left":"70%"}},[a("Button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary"},on:{click:e.sure}},[e._v("确定")]),e._v(" "),a("Button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},i=[];o._withStripped=!0;var r={render:o,staticRenderFns:i};t.default=r}});