webpackJsonp([7],{272:function(e,t,r){"use strict";function a(e){d||r(404)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(324),s=r.n(o);for(var i in o)"default"!==i&&function(e){r.d(t,e,function(){return o[e]})}(i);var n=r(406),l=r.n(n),d=!1,u=r(0),c=a,m=u(s.a,l.a,!1,c,"data-v-278f3918",null);m.options.__file="src\\views\\resource\\resource.vue",t.default=m.exports},324:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(31),s=a(o),i=r(63),n=a(i),l=r(32),d=a(l),u=r(100),c=a(u),m=r(2),p=a(m);t.default={inject:["reload"],data:function(){var e=this;return{SpinType:!1,ruleInline:{resourceName:[{required:!0,type:"string",pattern:/^[\u4e00-\u9fa5_a-zA-Z0-9]+$/,message:"请输入资源名称并不能为空",trigger:"blur"}],url:[{required:!0,message:"请输入url路径",trigger:"blur"}],mustUrl:[{required:!1,trigger:"blur"}]},formItem:{description:"",orderNo:100,resourceName:"",resourceId:[],url:"",mustUrl:"",isMenu:""},searchInfo:!1,addResource:!1,searchShow:!1,flag:0,searchWord:"",operation:{edit:!1,del:!1,edit_del:!1},columns1:[{title:"租户名称",key:"tenantName"},{title:"资源名称",key:"resourceName"},{title:"资源编码",key:"resourceCode"},{title:"是否为菜单",key:"isMenu",render:function(e,t){return e("div",[e("p",{style:{marginRight:"5px"}},0==t.row.isMenu?"否":"是")])}},{title:"上级资源名称",key:"parentName"},{title:"描述",key:"description"},{title:"更新时间",key:"modifyTime"},{title:"操作",key:"action",width:150,align:"center",render:function(t,r){return t("div",[e.operation.edit||e.operation.edit_del?t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.edit(r.index)}}},"修改"):"",e.operation.del||e.operation.edit_del?t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.remove(r.index)}}},"删除"):""])}}],data1:[],total:0,page:{pageIndex:1,pageSize:10},modal2:!1,real:[],isShow:!1}},created:function(){var e=this;p.default.remove("home_index"),p.default.remove("role_index"),p.default.remove("user_index"),this.$store.commit("resSearch"),0!==this.$store.state.app.resSearchFlag.length&&(this.searchWord=this.$store.state.app.resSearchFlag,this.res_List()),JSON.parse(localStorage.getItem("Jurisdiction"))?JSON.parse(localStorage.getItem("Jurisdiction")).forEach(function(t){t.child.forEach(function(t){"查询资源列表"==t.resourceName?e.searchShow=!0:"新增资源"==t.resourceName?e.addResource=!0:"修改资源"==t.resourceName?(e.operation.edit=!0,e.flag=1):"删除资源"==t.resourceName&&(1===e.flag?e.operation.edit_del=!0:e.operation.del=!0)})}):(this.$Message.error("无法检测到你的权限"),this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})),this.operation.edit||this.operation.del||this.columns1.splice(this.columns1.length-1,1),p.default.get("res_index")&&(this.page.pageIndex=Number(p.default.get("res_index")),p.default.remove("res_index")),this.res_List(),0==this.formItem.url?this.isShow=!1:this.isShow=!0},watch:{"formItem.isMenu":function(e,t){1==e?(this.isShow=!0,this.ruleInline.url=[]):(this.isShow=!1,this.ruleInline.url=[{required:!0,message:"请输入url路径",trigger:"blur"}])}},methods:{searchChange:function(){this.page.pageIndex=1,this.searchInfo=!0,this.$store.commit("resSearch",this.searchWord),this.res_List()},totol:function(e){this.page.pageIndex=e,this.res_List()},res_add:function(){this.$router.push({name:"addResources"})},res_List:function(){var e=this;this.SpinType=!0,this.$axios({method:"post",url:c.default.res_list(),data:{keyword:this.$store.state.app.resSearchFlag||"",currentPage:this.searchInfo?1:this.page.pageIndex||1,pageSize:this.page.pageSize},headers:{Authorization:p.default.get("token"),"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){200==t.data.code?(e.SpinType=!1,t.data.data?(e.data1=t.data.data,e.total=t.data.page.totalRecords):e.searchInfo?(e.data1=[],e.total=0):(--e.page.pageIndex,e.res_List()),e.searchInfo&&(e.page.pageIndex=1),e.searchInfo=!1):e.$Message.info(t.data.msg)})},remove:function(e){var t=this;this.$Modal.confirm({title:"删除警告",content:"<p>您确定要删除该资源吗</p>",loading:!0,onOk:function(){setTimeout(function(){p.default.set("del",t.page.pageIndex),t.$axios({method:"post",url:c.default.res_del(),data:{resourceId:t.data1[e].resourceId,userId:p.default.get("userId")},headers:{Authorization:p.default.get("token"),"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){200==e.data.code?t.data1.length<2?t.$axios({method:"post",url:c.default.res_list(),data:{keyword:t.searchWord,currentPage:1,pageSize:t.page.pageSize},headers:{Authorization:p.default.get("token"),"Content-Type":"application/json;charset=UTF-8"}}).then(function(e){200==e.data.code?e.data.data?(t.data1=e.data.data,t.total=e.data.page.totalRecords):(t.data1=[],t.total=0):t.$Message.info(e.data.msg)}):(t.$Message.info("已删除"),t.searchInfo=!0,t.res_List()):t.$Message.info(e.data.msg),t.$Modal.remove()})},0)}})},sure:function(){var e=this;this.$refs.formItem.validate(function(t){t&&(e.$axios({method:"post",url:c.default.res_update(),data:{description:e.formItem.description||"无",orderNo:e.formItem.orderNo||100,resourceId:e.formItem.resourceId,isMenu:e.formItem.isMenu,resourceName:e.formItem.resourceName,url:Number(e.formItem.isMenu)?e.formItem.url||"":e.formItem.url,userId:p.default.get("userId"),parentId:e.formItem.parentId},headers:{Authorization:p.default.get("token"),"Content-Type":"application/json;charset=UTF-8"}}).then(function(t){if(200===t.data.code){var r=e.data1[p.default.get("res_num")];new Date;r.description=e.formItem.description,r.orderNo=e.formItem.orderNo,r.resourceName=e.formItem.resourceName,r.url=e.formItem.url,r.isMenu=e.formItem.isMenu,e.reload()}else e.$Message.info(t.data.msg)}),e.$Message.info("已修改"),e.modal2=!1)})},cancel:function(){var e=this;this.data1.map(function(t){t.userId===e.real.userId&&n.default.apply(Object,[{}].concat((0,d.default)(e.real)))});this.$refs.formItem.resetFields(),this.modal2=!1,this.$Message.info("已取消")},edit:function(e){this.formItem=JSON.parse((0,s.default)(this.data1[e])),this.real=JSON.parse((0,s.default)(this.data1[e])),this.modal2=!0,p.default.set("res_num",e),p.default.set("res_index",this.page.pageIndex)}}}},404:function(e,t,r){var a=r(405);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(9)("907af946",a,!1)},405:function(e,t,r){t=e.exports=r(8)(!1),t.push([e.i,"\n.paging[data-v-278f3918] {\n    float: right;\n    margin-top: 10px;\n    margin-right: 15px;\n}\n",""])},406:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{position:"relative",height:"100%",padding:"10px"}},[r("Row",{staticClass:"code-row-bg",staticStyle:{"margin-bottom":"10px"},attrs:{type:"flex",justify:"space-between",align:"middle"}},[r("Col",{attrs:{span:"4"}},[r("h2",{staticStyle:{margin:"6px 0 0 20px"}},[e._v("资源接口")])]),e._v(" "),r("Col",{staticStyle:{"text-align":"right","margin-right":"15px",width:"35%"},attrs:{span:"2"}},[r("Input",{staticStyle:{width:"35%",height:"34px"},attrs:{size:"large",placeholder:"请输入搜索内容..."},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}}),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:e.searchChange}},[r("Icon",{staticStyle:{"font-size":"17px"},attrs:{type:"ios-search-strong"}})],1),e._v(" "),e.addResource?r("Button",{attrs:{type:"primary"},on:{click:e.res_add}},[e._v("新增资源")]):e._e()],1)],1),e._v(" "),r("Table",{staticStyle:{margin:"5px 15px 0 15px"},attrs:{columns:e.columns1,data:e.data1,id:"table1",loading:e.SpinType}}),e._v(" "),r("Page",{staticClass:"paging",attrs:{total:e.total,"page-size":e.page.pageSize,current:e.page.pageIndex,"show-total":""},on:{"on-change":e.totol}}),e._v(" "),r("Modal",{attrs:{title:"修改信息","footer-hide":!0,closable:!1,"mask-closable":!1},model:{value:e.modal2,callback:function(t){e.modal2=t},expression:"modal2"}},[r("Form",{ref:"formItem",attrs:{model:e.formItem,rules:e.ruleInline}},[r("FormItem",{attrs:{label:"描述",prop:"description"}},[r("Input",{attrs:{placeholder:"描述"},model:{value:e.formItem.description,callback:function(t){e.$set(e.formItem,"description",t)},expression:"formItem.description"}})],1),e._v(" "),r("FormItem",{attrs:{label:"排序号",prop:"orderNo"}},[r("Input",{attrs:{placeholder:"排列顺序"},model:{value:e.formItem.orderNo,callback:function(t){e.$set(e.formItem,"orderNo",t)},expression:"formItem.orderNo"}})],1),e._v(" "),r("FormItem",{attrs:{label:"资源名",prop:"resourceName"}},[r("Input",{attrs:{placeholder:"资源名称"},model:{value:e.formItem.resourceName,callback:function(t){e.$set(e.formItem,"resourceName",t)},expression:"formItem.resourceName"}})],1),e._v(" "),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],attrs:{label:"url路径",prop:"url"}},[r("Input",{model:{value:e.formItem.url,callback:function(t){e.$set(e.formItem,"url",t)},expression:"formItem.url"}})],1),e._v(" "),r("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],attrs:{label:"url路径",prop:"mustUrl"}},[r("Input",{model:{value:e.formItem.url,callback:function(t){e.$set(e.formItem,"url",t)},expression:"formItem.url"}})],1),e._v(" "),r("FormItem",{attrs:{label:"是否为菜单",prop:"isMenu"}},[r("RadioGroup",{model:{value:e.formItem.isMenu,callback:function(t){e.$set(e.formItem,"isMenu",t)},expression:"formItem.isMenu"}},[r("Radio",{attrs:{label:"1"}},[e._v("是")]),e._v(" "),r("Radio",{attrs:{label:"0"}},[e._v("否")])],1)],1)],1),e._v(" "),r("div",{staticStyle:{"margin-left":"70%"}},[r("Button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary"},on:{click:e.sure}},[e._v("确定")]),e._v(" "),r("Button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},o=[];a._withStripped=!0;var s={render:a,staticRenderFns:o};t.default=s}});